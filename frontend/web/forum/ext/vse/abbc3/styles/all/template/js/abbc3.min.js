var bbwizard,requestRunning=!1;!function(o){"use strict";bbwizard=function(e,i){if(!requestRunning){var t=o("#bbcode_wizard");if(!t.is(":visible")){requestRunning=!0;var n=phpbb.loadingIndicator();o.ajax({url:e,dataType:"html",beforeSend:function(){t.hide().empty()},success:function(e){t.append(e).fadeIn("fast")},error:function(){bbfontstyle("["+i+"]","[/"+i+"]")},complete:function(){requestRunning=!1,n&&n.is(":visible")&&n.fadeOut(phpbb.alertTime)}})}}};var c=function(e,i){var t;if(is_ie&&((t=document.forms[form_name].elements[text_name]).focus(),baseHeight=document.selection.createRange().duplicate().boundingHeight),insert_text(e+i),is_ie){var n=e+i,a=t.innerHTML.indexOf(n);if(0<a){var o=a+n.length,c=t.createTextRange();c.move("character",o),c.select(),storeCaret(t),t.focus()}}};o(document).ready(function(){var e=o("body");e.on("click",".spoilbtn",function(e){e.preventDefault();var i=o(this),t=i.closest("div").next(".spoilcontent");t.slideToggle("fast",function(){i.text(t.is(":visible")?i.data("hide"):i.data("show"))})});var a=o("#bbcode_wizard");e.on("click",function(){a.fadeOut("fast")}),a.on("click","#bbcode_wizard_submit",function(e){e.preventDefault();var i=o(this).data("bbcode");switch(i){case"url":var t=o("#bbcode_wizard_link").val(),n=o("#bbcode_wizard_description").val();c("["+i+(n.length?"="+t:"")+"]"+(n.length?n:t),"[/"+i+"]");break;case"bbvideo":c("[bbvideo]"+o("#bbvideo_wizard_link").val(),"[/bbvideo]")}a.fadeOut("fast")}).on("click","#bbcode_wizard_cancel",function(e){e.preventDefault(),a.fadeOut("fast")}).on("change","#bbvideo_wizard_sites",function(){o("#bbvideo_wizard_example").val(o(this).val())}).click(function(e){e.stopPropagation()})})}(jQuery);